; /* /bitrix/js/mobile/mobile_ui.min.js?15274018166349*/
; /* /bitrix/js/mobile/mobile_tools.min.js?15274018166195*/

; /* Start:"a:4:{s:4:"full";s:49:"/bitrix/js/mobile/mobile_ui.min.js?15274018166349";s:6:"source";s:30:"/bitrix/js/mobile/mobile_ui.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){if(window.BX.MobileUI)return;window.BX.MobileUI={TextField:{show:function(e){var t=BX.message("USER_ID");var i={smileButton:{},useImageButton:true,mentionDataSource:{outsection:false,url:"/mobile/index.php?mobile_action=get_user_list&use_name_format=Y"},attachFileSettings:{resize:{quality:40,destinationType:1,sourceType:1,targetWidth:1e3,targetHeight:1e3,encodingType:0,mediaType:0,allowsEdit:true,correctOrientation:"YES",saveToPhotoAlbum:"NO",popoverOptions:"NO",cameraDirection:0},showAttachedFiles:true,sendLocalFileMethod:"base64",maxAttachedFilesCount:1},attachButton:{items:[{id:"disk",name:BX.message("MUI_B24DISK"),dataSource:{multiple:"NO",url:"/mobile/?mobile_action=disk_folder_list&type=user&path=/&entityId="+t,TABLE_SETTINGS:{searchField:true,showtitle:true,modal:"YES",name:BX.message("MUI_CHOOSE_FILE_TITLE")}}},{id:"mediateka",name:BX.message("MUI_CHOOSE_PHOTO")},{id:"camera",name:BX.message("MUI_CAMERA_ROLL")}]}};if(e["text"]){i.text=e["text"]}if(e["placeholder"]){i.placeholder=e["placeholder"]}if(e["useSmiles"]&&e["useSmiles"]!=true){i.smileButton=""}if(e["useMentions"]&&e["useMentions"]!=true){i.mentionDataSource={}}if(e["onPlusPressed"]&&typeof e["onPlusPressed"]=="function"){delete i["attachButton"];i["plusAction"]=e["onPlusPressed"]}else if(e["useFilePanel"]&&e["useFilePanel"]!=true){delete i["attachButton"]}else{if(e["attachOptions"]){i["attachFileSettings"]["resize"]=e["attachOptions"]}if(e["attachUseBase64"]&&e["attachUseBase64"]==true){i["attachFileSettings"]["sendLocalFileMethod"]="base64"}if(e["attachSources"]){i["attachFileSettings"]["items"]=e["attachSources"]}}if(typeof(e["onSend"]=="function")){i.action=e["onSend"]}if(typeof(e["onEvent"]=="function")){i.callback=e["onEvent"]}BXMPage.TextPanel.show(i);return i}},createLoader:function(){var e={show:function(e){if(e){this.setText(e)}if(!this.view.parentNode){this.overlay.style.top=document.body.scrollTop+"px";this.view.style.top=document.body.scrollTop+screen.height/2-100+"px";document.body.appendChild(this.overlay);document.body.appendChild(this.view);document.body.addEventListener("touchmove",this._prevent)}return this},hide:function(){if(this.view.parentNode){e.view.parentNode.removeChild(this.overlay);e.view.parentNode.removeChild(this.view);document.body.removeEventListener("touchmove",this._prevent)}},_prevent:function(e){e.preventDefault()},onCancel:function(){return true},view:null,textView:null,setText:function(e){this.textView.innerHTML=e}};var t=function(){if(e.onCancel()){e.hide()}};var i=BX.create("TABLE",{props:{className:"mobile-iu-loader-wrap"},children:[BX.create("TR",{children:[BX.create("TD",{attrs:{height:"50px",style:"vertical-align:bottom;text-align: center"},children:[BX.create("DIV",{props:{className:"mobile-ui-loader"}})]})]}),BX.create("TR",{children:[BX.create("TD",{attrs:{height:"30px",style:"vertical-align:center;text-align: center"},children:[e.textView=BX.create("DIV",{props:{className:"mobile-ui-loader-message"}})]})]}),BX.create("TR",{children:[BX.create("TD",{props:{},attrs:{height:"50px",style:"text-align: center"},children:[BX.create("BUTTON",{html:BX.message("MUI_CANCEL"),events:{click:t}})]})]})]});e.view=i;e.overlay=BX.create("DIV",{props:{className:"mobile-iu-loader-overlay"}});return e},bottomPanel:function(){var e=function(e){BX.bind(e,"touchstart",function(){BX.addClass(e,"bottom_button_active")});BX.bind(e,"touchend",function(){BX.removeClass(e,"bottom_button_active")})};var t={holderContainer:null,holder:BX.create("DIV",{props:{className:"bottom_button_holder"}}),node:BX.create("DIV",{props:{className:"bottom-panel"}}),buttons:[],setButtons:function(t){this.clear();for(var i=0;i<t.length;i++){if(i>0){this.node.appendChild(BX.create("DIV",{props:{className:"bottom-panel-delimiter"}}))}this.buttons.push(BX.create("DIV",{html:t[i].name,events:{click:t[i].callback}}));if(t[i].className){BX.addClass(this.buttons[this.buttons.length-1],t[i].className)}e(this.buttons[this.buttons.length-1]);FastClick.attach(this.buttons[this.buttons.length-1]);BX.addClass(this.buttons[this.buttons.length-1],"bottom_button");this.node.appendChild(this.buttons[this.buttons.length-1])}document.body.appendChild(this.node);var n=this.holderContainer!=null?this.holderContainer:document.body;if(!this.holder.parentNode){n.appendChild(this.holder)}},clear:function(){if(this.node&&this.node.parentNode){this.node.parentNode.removeChild(this.node);while(this.node.firstChild){this.node.removeChild(this.node.firstChild)}}if(this.holder.parentNode){this.holder.parentNode.removeChild(this.holder)}}};return t}(),addCopyableDialog:function(e,t,i,n){BX.MobileApp.Gesture.addLongTapListener(e,function(o){var s=BX.findParent(o,{className:t},e);if(!s)return false;var a;if(i){var l=BX.findChild(s,{className:i},true);if(l){a=l}}else{a=s}if(!a){return false}BX.addClass(s,"long-tap-activate");new BXMobileApp.UI.ActionSheet({buttons:[{title:BX.message("MUI_COPY"),callback:function(){var e=null;if(typeof n==="function"){e=n(a)}else{e=a.innerHTML}if(e!==null){app.exec("copyToClipboard",{text:e});new BXMobileApp.UI.NotificationBar({message:BX.message("MUI_TEXT_COPIED"),color:"#3a3735",textColor:"#ffffff",groupId:"clipboard",maxLines:1,align:"center",isGlobal:true,useCloseButton:true,autoHideTimeout:1e3,hideOnTap:true},"copy").show()}}}]},"copydialog").show();app.exec("callVibration");setTimeout(function(){BX.removeClass(s,"long-tap-activate")},1e3)})},List:new function(){var e=function(e){var t=null;if(e.objectId){t=new function e(t,i){this.internalId=t;this.id=i;this.showMenu=function(e,t){window.BX.MobileUI.List.instance.exec("showMenu",{title:t,items:e,internalId:this.internalId})}}(e.objectId.internalId,e.objectId.id)}BX.onCustomEvent("onMobileList"+(typeof e.objectId.id!="undefined"?"_"+e.objectId.id:""),[e.eventName,e.params,t])};this.Events={ON_ITEM_MORE_CHOOSED:"onOverflowListChoose",ON_MENU_ITEM_CHOOSED:"onOverflowListMenuChoose"};this.show=function(e,t){e.id=t;if(app.enableInVersion(20)){window.BX.MobileUI.List.instance.exec("show",e)}else{new BXMobileApp.UI.Table(e).show()}};this.addListener=function(e,t){BX.addCustomEvent("onMobileList"+(typeof t!="undefined"?"_"+t:""),e)};this.instance=new BXCordovaPlugin("ListCordovaPlugin");this.instance.exec("init",{eventListener:BX.proxy(e,this),jsCallbackProvider:"window.BX.MobileUI.List.instance"})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:52:"/bitrix/js/mobile/mobile_tools.min.js?15274018166195";s:6:"source";s:33:"/bitrix/js/mobile/mobile_tools.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(e){if(e.BX.MobileTools)return;BX.MobileTools={phoneTo:function(e,o){o=typeof o=="object"?o:{};if(!this.canUseTelephony()){o.callMethod="device"}if(o.callMethod=="telephony"){BXMobileApp.onCustomEvent("onPhoneTo",{number:e,params:o},true)}else if(o.callMethod=="device"){document.location.href="tel:"+this.correctNumberForPstn(e)}else{var i=[];i.push({title:BX.message("MOBILE_CALL_BY_B24"),callback:function(){o.callMethod="telephony";this.phoneTo(e,o)}.bind(this)});i.push({title:BX.message("MOBILE_CALL_BY_MOBILE"),callback:function(){o.callMethod="device";this.phoneTo(e,o)}.bind(this)});new BXMobileApp.UI.ActionSheet({buttons:i},"im-phone-menu").show()}},callTo:function(e,o){o=typeof o=="undefined"?false:o;BXMobileApp.onCustomEvent("onCallInvite",{userId:e,video:o},true)},correctNumberForPstn:function(e){if(!BX.type.isNotEmptyString(e))return e;if(e.length<10)return e;if(e.substr(0,1)==="+")return e;if(e.substr(0,3)==="011")return e;if(e.substr(0,2)==="82")return"+"+e;else if(e.substr(0,1)==="8")return e;return"+"+e},canUseTelephony:function(){return BX.message("can_perform_calls")==="Y"},getMobileUrlParams:function(e){var o=[{exp:/\/company\/personal\/user\/(\d+)\/calendar\/\?EVENT_ID=(\d+).*/gi,replace:"/mobile/calendar/view_event.php?event_id=$2",useNewStyle:false},{exp:/\/company\/personal\/user\/(\d+)\/tasks\/task\/view\/(\d+)\//gi,replace:"/mobile/tasks/snmrouter/?routePage=view&USER_ID=$1&GROUP_ID=0&TASK_ID=$2",useNewStyle:true},{exp:/\/company\/personal\/user\/(\d+)\/tasks\//gi,replace:"/mobile/tasks/snmrouter/?routePage=list&USER_ID=$1",useNewStyle:true},{exp:/\/workgroups\/group\/(\d+)\/tasks\/task\/view\/(\d+)\//gi,replace:"/mobile/tasks/snmrouter/?routePage=view&GROUP_ID=$1&TASK_ID=$2",useNewStyle:true},{exp:/\/company\/personal\/user\/(\d+)\/blog\/(\d+)\/\?commentId=(\d+)#com(\d+)/gi,replace:"/mobile/log/?ACTION=CONVERT&ENTITY_TYPE_ID=BLOG_POST&ENTITY_ID=$2&commentId=$3#com$4",useNewStyle:true},{exp:/\/company\/personal\/user\/(\d+)\/blog\/(\d+)\//gi,replace:"/mobile/log/?ACTION=CONVERT&ENTITY_TYPE_ID=BLOG_POST&ENTITY_ID=$2",useNewStyle:true},{exp:/\/company\/personal\/log\/(\d+)\//gi,replace:"/mobile/log/?ACTION=CONVERT&ENTITY_TYPE_ID=LOG_ENTRY&ENTITY_ID=$1",useNewStyle:true},{exp:/\/company\/personal\/user\/(\d+)\//gi,replace:"/mobile/users/?user_id=$1",useNewStyle:true},{exp:/\/crm\/(deal|lead|company|contact)\/show\/(\d+)\//gi,replace:"/mobile/crm/$1/?page=view&$1_id=$2",useNewStyle:true},{exp:/\/workgroups\/group\/(\d+)\//gi,replace:"/mobile/?group_id=$1",useNewStyle:true}];var i=null;for(var t=0;t<o.length;t++){var r=e.replace(o[t].exp,o[t].replace);if(r!=e){i={url:r,bx24ModernStyle:o[t].useNewStyle};break}}return i},createCardScanner:function(e){return new function o(){this.onError=function(e){console.error("Error",e)};this.stripEmptyFields=e.stripEmptyFields||false;this.options=e;this.imageData=null;if(e["onResult"]){this.onResult=e["onResult"]}if(e["onError"]){this.onError=e["onError"]}if(e["onImageGet"]){this.onImageGet=e["onImageGet"]}this.open=function(){app.exec("openBusinessCardScanner",{callback:BX.proxy(function(e){if(e.canceled!=1&&e.url.length>0){this.imageData=e;if(this.options["onImageGet"]){this.onImageGet(e)}this.send()}},this)})};this.send=function(){if(this.options.url){var e=new FileUploadOptions;e.fileKey="card_file";e.fileName="image.jpg";e.mimeType="image/jpeg";e.chunkedMode=false;e.params={image:"Y"};var o=new FileTransfer;o.upload(this.imageData.url,this.options.url,BX.proxy(function(e){try{var o=JSON.parse(e.response);this.UNIQUE_ID=o.UNIQUE_ID;if(o.STATUS!="success"){if(o.ERROR){this.onError(o.ERROR)}return}else{this.options["onImageUploaded"](o)}BXMobileApp.addCustomEvent("onPull-bizcard",this.handler)}catch(e){this.onError(e)}},this),BX.proxy(function(e){this.onError({code:e.code,message:"Can't upload image"})},this),e)}};this.handler=BX.proxy(function(e){var o=e.params.RESULT;if(!o.ERROR&&o.UNIQUE_ID==this.UNIQUE_ID){BX.removeCustomEvent("onPull-bizcard",this.handler);if(typeof this.onResult=="function"){var i=o.DATA;var t={DATA:{},CARD_ID:o.CARD_ID};if(typeof i=="object"){if(this.stripEmptyFields){var r={};for(var n in i){if(i[n]!="")r[n]=i[n]}t.DATA=r}else{t.DATA=i}this.onResult(t)}else{this.onError(o)}}}},this)}},requestUserCounters:function(){BXMobileApp.onCustomEvent("requestUserCounters",{web:true},true)}};var o={onLiveFeedFavoriteView:/\/mobile\/index.php\?favorites=Y/gi,onCalendarEventView:/\/mobile\/calendar\/view_event.php\?event_id=(\d+)*/gi,onTaskView:/\/mobile\/tasks\/snmrouter\/\?routePage=view(.*)TASK_ID=/gi,onTaskListView:/\/mobile\/tasks\/snmrouter\/\?routePage=roles/gi,onTaskCreate:/\/mobile\/tasks\/snmrouter\/\?routePage=edit(.*)TASK_ID=0/gi,onTaskEdit:/\/mobile\/tasks\/snmrouter\/\?routePage=edit(.*)TASK_ID=(\d+)/gi,onUserProfileView:/\/mobile\/users\/\?user_id=(.*)/gi,onCRMInvoiceList:/\/mobile\/crm\/invoice/gi,onCRMLeadList:/\/mobile\/crm\/lead/gi,onCRMDealList:/\/mobile\/crm\/deal/gi,onCRMContactList:/\/mobile\/crm\/contact/gi,onCRMActivityList:/\/mobile\/crm\/activity\/list.php/gi,onCRMContactView:/\/mobile\/crm\/contact\/\?page=view&contact_id=/gi,onCRMDealView:/\/mobile\/crm\/deal\/\?page=view&deal_id=/gi,onCRMCompanyView:/\/mobile\/crm\/company\/\?page=view&company_id=/gi,onCRMLeadView:/\/mobile\/crm\/lead\/\?page=view&lead_id=/gi,onCRMQuoteView:/\/mobile\/crm\/quote\/\?page=view&quote_id=/gi,onCRMProductView:/\/mobile\/crm\/product\/\?page=view&product_id=/gi,onGroupView:/\/mobile\/\?group_id=(.*)/gi,onBizProcListView:/\/mobile\/bp\/\?USER_STATUS=0$/gi};var i=function(e){for(var i in o){if(e.match(o[i]))return i}return null};var t=app.loadPageBlank;var r=app.loadPageStart;var n=app.showModalDialog;if(e.mwebrtc){var a=e.mwebrtc.callInvite;e.mwebrtc.callInvite=function(){var o="Outgoing"+(arguments[1]===true?"Video":"Audio")+"Call";a.apply(e.mwebrtc,arguments);if(o&&fabric){fabric.Answers.sendCustomEvent(o,{})}}}var s=function(e){var o=typeof e=="object"?e.url:e;var t=i(o);if(t&&fabric){fabric.Answers.sendCustomEvent(t,{})}};app.showModalDialog=function(e){BX.proxy(n,app)(e);s(e)};app.loadPageBlank=function(e){BX.proxy(t,app)(e);s(e)};app.loadPageStart=function(e){BX.proxy(r,app)(e);s(e)}})(window);
/* End */
;